Index: u-boot-omnia-2019-04/configs/turris_omnia_defconfig
===================================================================
--- u-boot-omnia-2019-04.orig/configs/turris_omnia_defconfig
+++ u-boot-omnia-2019-04/configs/turris_omnia_defconfig
@@ -61,3 +61,13 @@ CONFIG_USB_XHCI_HCD=y
 CONFIG_USB_XHCI_MVEBU=y
 CONFIG_WDT=y
 CONFIG_WDT_ORION=y
+CONFIG_FIT=y
+CONFIG_FIT_ENABLE_SHA256_SUPPORT=y
+CONFIG_FIT_SIGNATURE=n
+CONFIG_FIT_VERBOSE=y
+CONFIG_FIT_BEST_MATCH=n
+CONFIG_CMD_LZMADEC=y
+CONFIG_CMD_AES=y
+CONFIG_CMD_HASH=y
+CONFIG_CMD_SHA1SUM=y
+CONFIG_BOOTCOMMAND="run turris_boot"
Index: u-boot-omnia-2019-04/include/configs/turris_omnia.h
===================================================================
--- u-boot-omnia-2019-04.orig/include/configs/turris_omnia.h
+++ u-boot-omnia-2019-04/include/configs/turris_omnia.h
@@ -146,6 +146,8 @@
 	LOAD_ADDRESS_ENV_SETTINGS \
 	"fdtfile=" CONFIG_DEFAULT_DEVICE_TREE ".dtb\0" \
 	"console=ttyS0,115200\0" \
+	"turris_boot=i2c dev 1; i2c read 0x2a 0x9 1 0x00FFFFF0; setexpr.b rescue *0x00FFFFF0; if test $rescue -ge 1; then echo rescueboot; run rescue_boot; else echo distro_boot; run distro_bootcmd; fi\0" \
+	"rescue_boot=i2c mw 0x2a.1 0x3 0x1c 1; i2c mw 0x2a.1 0x4 0x1c 1; mw.l 0x01000000 0x00ff000c; i2c write 0x01000000 0x2a.1 0x5 4 -s; setenv bootargs \"$bootargs omniarescue=$rescue\"; sf probe; sf read 0x1000000 0x100000 0x700000; bootm 0x1000000; bootz 0x1000000\0" \
 	BOOTENV
 
 #endif /* CONFIG_SPL_BUILD */
Index: u-boot-omnia-2019-04/cmd/pxe.c
===================================================================
--- u-boot-omnia-2019-04.orig/cmd/pxe.c
+++ u-boot-omnia-2019-04/cmd/pxe.c
@@ -22,6 +22,9 @@
 
 const char *pxe_default_paths[] = {
 #ifdef CONFIG_SYS_SOC
+#ifdef CONFIG_SYS_BOARD
+	"default-" CONFIG_SYS_ARCH "-" CONFIG_SYS_SOC "-" CONFIG_SYS_BOARD,
+#endif
 	"default-" CONFIG_SYS_ARCH "-" CONFIG_SYS_SOC,
 #endif
 	"default-" CONFIG_SYS_ARCH,
