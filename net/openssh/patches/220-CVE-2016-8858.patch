===================================================================
RCS file: /cvs/src/usr.bin/ssh/kex.c,v
retrieving revision 1.126
retrieving revision 1.127
Index: openssh-7.3p1/kex.c
===================================================================
--- openssh-7.3p1.orig/kex.c
+++ openssh-7.3p1/kex.c
@@ -472,6 +472,7 @@ kex_input_kexinit(int type, u_int32_t se
 	if (kex == NULL)
 		return SSH_ERR_INVALID_ARGUMENT;
 
+	ssh_dispatch_set(ssh, SSH2_MSG_KEXINIT, NULL);
 	ptr = sshpkt_ptr(ssh, &dlen);
 	if ((r = sshbuf_put(kex->peer, ptr, dlen)) != 0)
 		return r;
