From 510de936f031df16e26975d2936396ff3947116a Mon Sep 17 00:00:00 2001
From: Michal Hrusecky <Michal@Hrusecky.net>
Date: Thu, 22 Mar 2018 13:07:22 +0100
Subject: [PATCH] Drop preloading data to speed up things

---
 src/__init__.py                  |  4 ----
 src/templates/pakon/_results.tpl |  5 -----
 src/templates/pakon/pakon.tpl    | 15 +--------------
 3 files changed, 1 insertion(+), 23 deletions(-)

diff --git a/src/__init__.py b/src/__init__.py
index b20b03a..636f106 100644
--- a/src/__init__.py
+++ b/src/__init__.py
@@ -41,10 +41,6 @@ class PakonPluginPage(ConfigPageMixin, PakonPluginConfigHandler):
         args['PLUGIN_STYLES'] = PakonPlugin.PLUGIN_STYLES
         args['PLUGIN_STATIC_SCRIPTS'] = PakonPlugin.PLUGIN_STATIC_SCRIPTS
         args['PLUGIN_DYNAMIC_SCRIPTS'] = PakonPlugin.PLUGIN_DYNAMIC_SCRIPTS
-        args['query'] = json.dumps({})
-        data = current_state.backend.perform(
-            "pakon", "perform_query", {"query_data": args['query']})
-        args['results'] = self._prepare_data(data)
 
     def render(self, **kwargs):
         self._prepare_render_args(kwargs)
diff --git a/src/templates/pakon/_results.tpl b/src/templates/pakon/_results.tpl
index 12faa7c..fb8c05a 100644
--- a/src/templates/pakon/_results.tpl
+++ b/src/templates/pakon/_results.tpl
@@ -1,8 +1,3 @@
 <div id="pakon-results">
-    %if reversed(results):
     <table id="pakon-results-table"></table>
-
-    %else:
-    <p>{{ trans("No results found.") }}</p>
-    %end
 </div>
diff --git a/src/templates/pakon/pakon.tpl b/src/templates/pakon/pakon.tpl
index f1b8fae..1c4f05a 100644
--- a/src/templates/pakon/pakon.tpl
+++ b/src/templates/pakon/pakon.tpl
@@ -4,19 +4,6 @@
 <div id="page-pakon-plugin" class="config-page">
     %include("_messages.tpl")
 
-    <!--
-    <form action="{{ url("config_action", page_name="pakon", action="perform_query") }}" class="config-form" method="post">
-        <div class="row">
-        <label for="field-lan_ipaddr">Router IP address</label>
-        <input name="query" value="{{ query }}" type="text" id="field-query"/>
-        <input type="hidden" name="csrf_token" value="{{ get_csrf_token() }}" id="csrf-token">
-        </div>
-        <div class="row">
-        <button type="submit" name="action" id="pakon-query-trigger" value="query-trigger" class="button">{{ trans("Query") }}</button>
-        </div>
-    </form>
-    -->
-
     <fieldset>
         <legend>{{ trans("Data view - settings") }}:</legend>
         <label for="date-from">
@@ -67,7 +54,7 @@
     <div id="pakon-results-statistics"></div>
 
     <h3>{{ trans("Results") }}</h3>
-    %include("pakon/_results.tpl", results=results)
+    %include("pakon/_results.tpl")
 </div>
 
 <script>
-- 
2.16.2

